"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[990],{31990:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var r=n(86171),o=n(50959),a=n(91324);function i(e,t,n){const{gl:i,size:s,viewport:l}=(0,a.z)(),c="number"==typeof e?e:s.width*l.dpr,u="number"==typeof t?t:s.height*l.dpr,d=("number"==typeof e?n:e)||{},{samples:f,...m}=d,p=o.useMemo((()=>{let e;return e=new r.WebGLRenderTarget(c,u,{minFilter:r.LinearFilter,magFilter:r.LinearFilter,encoding:i.outputEncoding,type:r.HalfFloatType,...m}),e.samples=f,e}),[]);return o.useLayoutEffect((()=>{p.setSize(c,u),f&&(p.samples=f)}),[f,p,c,u]),o.useEffect((()=>()=>p.dispose()),[]),p}var s=n(24250);var l=function(e){return function(t){e.forEach((function(e){"function"==typeof e?e(t):null!=e&&(e.current=t)}))}};class c extends r.ShaderMaterial{constructor(){super({uniforms:{depth:{value:null},opacity:{value:1},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new r.Vector3(0,0,0)},lightColor:{value:new r.Color("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new r.Vector2(0,0)}},transparent:!0,depthWrite:!1,vertexShader:"\n      varying vec3 vNormal;\n      varying vec3 vWorldPosition;\n      varying float vViewZ;\n      varying float vIntensity;\n      uniform vec3 spotPosition;\n      uniform float attenuation;      \n\n      void main() {\n        // compute intensity\n        vNormal = normalize( normalMatrix * normal );\n        vec4 worldPosition\t= modelMatrix * vec4( position, 1.0 );\n        vWorldPosition = worldPosition.xyz;\n        vec4 viewPosition = viewMatrix * worldPosition;\n        vViewZ = viewPosition.z;\n        float intensity\t= distance(worldPosition.xyz, spotPosition) / attenuation;\n        intensity\t= 1.0 - clamp(intensity, 0.0, 1.0);\n        vIntensity = intensity;        \n        // set gl_Position\n        gl_Position\t= projectionMatrix * viewPosition;\n\n      }",fragmentShader:"\n      #include <packing>\n\n      varying vec3 vNormal;\n      varying vec3 vWorldPosition;\n      uniform vec3 lightColor;\n      uniform vec3 spotPosition;\n      uniform float attenuation;\n      uniform float anglePower;\n      uniform sampler2D depth;\n      uniform vec2 resolution;\n      uniform float cameraNear;\n      uniform float cameraFar;\n      varying float vViewZ;\n      varying float vIntensity;\n      uniform float opacity;\n\n      float readDepth( sampler2D depthSampler, vec2 coord ) {\n        float fragCoordZ = texture2D( depthSampler, coord ).x;\n        float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\n        return viewZ;\n      }\n\n      void main() {\n        float d = 1.0;\n        bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;\n        if (isSoft) {\n          vec2 sUv = gl_FragCoord.xy / resolution;\n          d = readDepth(depth, sUv);\n        }\n        float intensity = vIntensity;\n        vec3 normal\t= vec3(vNormal.x, vNormal.y, abs(vNormal.z));\n        float angleIntensity\t= pow( dot(normal, vec3(0.0, 0.0, 1.0)), anglePower );\n        intensity\t*= angleIntensity;\n        // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry\n        if (isSoft) {\n          intensity\t*= smoothstep(0., 1., vViewZ - d);\n        }\n        gl_FragColor = vec4(lightColor, intensity * opacity);\n\n        #include <tonemapping_fragment>\n\t      #include <encodings_fragment>\n      }"})}}function u({opacity:e=1,radiusTop:t,radiusBottom:n,depthBuffer:i,color:s="white",distance:l=5,angle:u=.15,attenuation:d=5,anglePower:f=5}){const m=o.useRef(null),p=(0,a.z)((e=>e.size)),h=(0,a.z)((e=>e.camera)),g=(0,a.z)((e=>e.viewport.dpr)),[v]=o.useState((()=>new c)),[y]=o.useState((()=>new r.Vector3));t=void 0===t?.1:t,n=void 0===n?7*u:n,(0,a.A)((()=>{v.uniforms.spotPosition.value.copy(m.current.getWorldPosition(y)),m.current.lookAt(m.current.parent.target.getWorldPosition(y))}));const w=o.useMemo((()=>{const e=new r.CylinderGeometry(t,n,l,128,64,!0);return e.applyMatrix4((new r.Matrix4).makeTranslation(0,-l/2,0)),e.applyMatrix4((new r.Matrix4).makeRotationX(-Math.PI/2)),e}),[l,t,n]);return o.createElement(o.Fragment,null,o.createElement("mesh",{ref:m,geometry:w,raycast:()=>null},o.createElement("primitive",{object:v,attach:"material","uniforms-opacity-value":e,"uniforms-lightColor-value":s,"uniforms-attenuation-value":d,"uniforms-anglePower-value":f,"uniforms-depth-value":i,"uniforms-cameraNear-value":h.near,"uniforms-cameraFar-value":h.far,"uniforms-resolution-value":i?[p.width*g,p.height*g]:[0,0]})))}const d=o.forwardRef((({opacity:e=1,radiusTop:t,radiusBottom:n,depthBuffer:r,color:a="white",distance:i=5,angle:c=.15,attenuation:d=5,anglePower:f=5,volumetric:m=!0,debug:p=!1,children:h,...g},v)=>{const y=o.useRef(null);return o.createElement("group",null,p&&y.current&&o.createElement("spotLightHelper",{args:[y.current]}),o.createElement("spotLight",(0,s.Z)({ref:l([v,y]),angle:c,color:a,distance:i,castShadow:!0},g),m&&o.createElement(u,{debug:p,opacity:e,radiusTop:t,radiusBottom:n,depthBuffer:r,color:a,distance:i,angle:c,attenuation:d,anglePower:f})),h&&o.cloneElement(h,{spotlightRef:y,debug:p}))}));var f=n(936);const m=o.forwardRef((({envMap:e,resolution:t=256,frames:n=1/0,makeDefault:r,children:c,...u},d)=>{const f=(0,a.z)((({set:e})=>e)),m=(0,a.z)((({camera:e})=>e)),p=(0,a.z)((({size:e})=>e)),h=o.useRef(null),g=o.useRef(null),v=i(t);o.useLayoutEffect((()=>{u.manual||(h.current.aspect=p.width/p.height)}),[p,u]),o.useLayoutEffect((()=>{h.current.updateProjectionMatrix()}));let y=0,w=null;const b="function"==typeof c;return(0,a.A)((t=>{b&&(n===1/0||y<n)&&(g.current.visible=!1,t.gl.setRenderTarget(v),w=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,h.current),t.scene.background=w,t.gl.setRenderTarget(null),g.current.visible=!0,y++)})),o.useLayoutEffect((()=>{if(r){const e=m;return f((()=>({camera:h.current}))),()=>f((()=>({camera:e})))}}),[h,r,f]),o.createElement(o.Fragment,null,o.createElement("perspectiveCamera",(0,s.Z)({ref:l([h,d])},u),!b&&c),o.createElement("group",{ref:g},b&&c(v.texture)))}));class p extends r.DataTextureLoader{constructor(e){super(e),this.type=r.HalfFloatType}parse(e){const t=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},n=function(e,t,n){t=t||1024;let r=e.pos,o=-1,a=0,i="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(o=s.indexOf("\n"))&&a<t&&r<e.byteLength;)i+=s,a+=s.length,r+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<o&&(!1!==n&&(e.pos+=a+o+1),i+s.slice(0,o))},o=function(e,t,n,r){const o=e[t+3],a=Math.pow(2,o-128)/255;n[r+0]=e[t+0]*a,n[r+1]=e[t+1]*a,n[r+2]=e[t+2]*a,n[r+3]=1},a=function(e,t,n,o){const a=e[t+3],i=Math.pow(2,a-128)/255;n[o+0]=r.DataUtils.toHalfFloat(Math.min(e[t+0]*i,65504)),n[o+1]=r.DataUtils.toHalfFloat(Math.min(e[t+1]*i,65504)),n[o+2]=r.DataUtils.toHalfFloat(Math.min(e[t+2]*i,65504)),n[o+3]=r.DataUtils.toHalfFloat(1)},i=new Uint8Array(e);i.pos=0;const s=function(e){const r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,i=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,s={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;if(e.pos>=e.byteLength||!(l=n(e)))return t(1,"no header found");if(!(c=l.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(s.valid|=1,s.programtype=c[1],s.string+=l+"\n";l=n(e),!1!==l;)if(s.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(r))&&(s.gamma=parseFloat(c[1])),(c=l.match(o))&&(s.exposure=parseFloat(c[1])),(c=l.match(a))&&(s.valid|=2,s.format=c[1]),(c=l.match(i))&&(s.valid|=4,s.height=parseInt(c[1],10),s.width=parseInt(c[2],10)),2&s.valid&&4&s.valid)break}else s.comments+=l+"\n";return 2&s.valid?4&s.valid?s:t(3,"missing image size specifier"):t(3,"missing format specifier")}(i);if(-1!==s){const e=s.width,n=s.height,l=function(e,n,r){const o=n;if(o<8||o>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(o!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");const a=new Uint8Array(4*n*r);if(!a.length)return t(4,"unable to allocate buffer space");let i=0,s=0;const l=4*o,c=new Uint8Array(4),u=new Uint8Array(l);let d=r;for(;d>0&&s<e.byteLength;){if(s+4>e.byteLength)return t(1);if(c[0]=e[s++],c[1]=e[s++],c[2]=e[s++],c[3]=e[s++],2!=c[0]||2!=c[1]||(c[2]<<8|c[3])!=o)return t(3,"bad rgbe scanline format");let n,r=0;for(;r<l&&s<e.byteLength;){n=e[s++];const o=n>128;if(o&&(n-=128),0===n||r+n>l)return t(3,"bad scanline data");if(o){const t=e[s++];for(let e=0;e<n;e++)u[r++]=t}else u.set(e.subarray(s,s+n),r),r+=n,s+=n}const f=o;for(let e=0;e<f;e++){let t=0;a[i]=u[e+t],t+=o,a[i+1]=u[e+t],t+=o,a[i+2]=u[e+t],t+=o,a[i+3]=u[e+t],i+=4}d--}return a}(i.subarray(i.pos),e,n);if(-1!==l){let t,i,c;switch(this.type){case r.FloatType:c=l.length/4;const e=new Float32Array(4*c);for(let t=0;t<c;t++)o(l,4*t,e,4*t);t=e,i=r.FloatType;break;case r.HalfFloatType:c=l.length/4;const n=new Uint16Array(4*c);for(let e=0;e<c;e++)a(l,4*e,n,4*e);t=n,i=r.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:e,height:n,data:t,header:s.string,gamma:s.gamma,exposure:s.exposure,type:i}}}return null}setDataType(e){return this.type=e,this}load(e,t,n,o){return super.load(e,(function(e,n){switch(e.type){case r.FloatType:case r.HalfFloatType:e.encoding=r.LinearEncoding,e.minFilter=r.LinearFilter,e.magFilter=r.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)}),n,o)}}class h extends r.Mesh{constructor(e,t){var n,o;const a=(i=e)&&i.isCubeTexture;var i;const s=(null!=(n=a?null===(o=e.image[0])||void 0===o?void 0:o.width:e.image.width)?n:1024)/4,l=Math.floor(Math.log2(s)),c=Math.pow(2,l),u=[a?"#define ENVMAP_TYPE_CUBE":"","#define CUBEUV_TEXEL_WIDTH "+1/(3*Math.max(c,112)),"#define CUBEUV_TEXEL_HEIGHT "+1/(4*c),`#define CUBEUV_MAX_MIP ${l}.0`].join("\n")+"\n        #define ENVMAP_TYPE_CUBE_UV\n        varying vec3 vWorldPosition;\n        uniform float radius;\n        uniform float height;\n        uniform float angle;\n        #ifdef ENVMAP_TYPE_CUBE\n            uniform samplerCube map;\n        #else\n            uniform sampler2D map;\n        #endif\n        // From: https://www.shadertoy.com/view/4tsBD7\n        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) \n        {\n            float d = dot ( rd, n );\n            \n            if( d > 0.0 ) { return 1e6; }\n            \n            vec3  o = ro - c;\n            float t = - dot( n, o ) / d;\n            vec3  q = o + rd * t;\n            \n            return ( dot( q, q ) < r * r ) ? t : 1e6;\n        }\n        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm\n        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) \n        {\n            vec3 oc = ro - ce;\n            float b = dot( oc, rd );\n            float c = dot( oc, oc ) - ra * ra;\n            float h = b * b - c;\n            \n            if( h < 0.0 ) { return -1.0; }\n            \n            h = sqrt( h );\n            \n            return - b + h;\n        }\n        vec3 project() \n        {\n            vec3 p = normalize( vWorldPosition );\n            vec3 camPos = cameraPosition;\n            camPos.y -= height;\n            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );\n            if( intersection > 0.0 ) {\n                \n                vec3 h = vec3( 0.0, - height, 0.0 );\n                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );\n                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;\n            } else {\n                p = vec3( 0.0, 1.0, 0.0 );\n            }\n            return p;\n        }\n        #include <common>\n        #include <cube_uv_reflection_fragment>\n        void main() \n        {\n            vec3 projectedWorldPosition = project();\n            \n            #ifdef ENVMAP_TYPE_CUBE\n                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;\n            #else\n                vec3 direction = normalize( projectedWorldPosition );\n                vec2 uv = equirectUv( direction );\n                vec3 outcolor = texture2D( map, uv ).rgb;\n            #endif\n            gl_FragColor = vec4( outcolor, 1.0 );\n            #include <tonemapping_fragment>\n            #include <encodings_fragment>\n        }\n        ",d={map:{value:e},height:{value:(null==t?void 0:t.height)||15},radius:{value:(null==t?void 0:t.radius)||100}};super(new r.IcosahedronGeometry(1,16),new r.ShaderMaterial({uniforms:d,fragmentShader:u,vertexShader:"\n        varying vec3 vWorldPosition;\n        void main() \n        {\n            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );\n            vWorldPosition = worldPosition.xyz;\n            \n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n        ",side:r.DoubleSide}))}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}const g={sunset:"venice/venice_sunset_1k.hdr",dawn:"kiara/kiara_1_dawn_1k.hdr",night:"dikhololo/dikhololo_night_1k.hdr",warehouse:"empty-wharehouse/empty_warehouse_01_1k.hdr",forest:"forrest-slope/forest_slope_1k.hdr",apartment:"lebombo/lebombo_1k.hdr",studio:"studio-small-3/studio_small_03_1k.hdr",city:"potsdamer-platz/potsdamer_platz_1k.hdr",park:"rooitou/rooitou_park_1k.hdr",lobby:"st-fagans/st_fagans_interior_1k.hdr"};function v(e,t,n,r,o=0){const a=(e=>{return(t=e).current&&t.current.isScene?e.current:e;var t})(t||n),i=a.background,s=a.environment,l=a.backgroundBlurriness||0;return"only"!==e&&(a.environment=r),e&&(a.background=r),e&&void 0!==a.backgroundBlurriness&&(a.backgroundBlurriness=o),()=>{"only"!==e&&(a.environment=s),e&&(a.background=i),e&&void 0!==a.backgroundBlurriness&&(a.backgroundBlurriness=l)}}function y({scene:e,background:t=!1,blur:n,map:r}){const i=(0,a.z)((e=>e.scene));return o.useLayoutEffect((()=>{if(r)return v(t,e,i,r,n)}),[i,e,r,t,n]),null}function w({files:e=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:t="",preset:n,encoding:o,extensions:i}){if(n){if(!(n in g))throw new Error("Preset must be one of: "+Object.keys(g).join(", "));e=g[n],t="https://market-assets.fra1.cdn.digitaloceanspaces.com/market-assets/hdris/"}const s=Array.isArray(e),l=s?r.CubeTextureLoader:p,c=(0,a.D)(l,s?[e]:e,(e=>{e.setPath(t),i&&i(e)})),u=s?c[0]:c;return u.mapping=s?r.CubeReflectionMapping:r.EquirectangularReflectionMapping,u.encoding=(null!=o?o:s)?r.sRGBEncoding:r.LinearEncoding,u}function b({background:e=!1,scene:t,blur:n,...r}){const i=w(r),s=(0,a.z)((e=>e.scene));return o.useLayoutEffect((()=>v(e,t,s,i,n)),[i,e,t,s,n]),null}function E({children:e,near:t=1,far:n=1e3,resolution:i=256,frames:s=1,map:l,background:c=!1,blur:u,scene:d,files:f,path:m,preset:p,extensions:h}){const g=(0,a.z)((e=>e.gl)),w=(0,a.z)((e=>e.scene)),E=o.useRef(null),[x]=o.useState((()=>new r.Scene)),P=o.useMemo((()=>{const e=new r.WebGLCubeRenderTarget(i);return e.texture.type=r.HalfFloatType,e}),[i]);o.useLayoutEffect((()=>(1===s&&E.current.update(g,x),v(c,d,w,P.texture,u))),[e,x,P.texture,d,w,c,s,g]);let k=1;return(0,a.A)((()=>{(s===1/0||k<s)&&(E.current.update(g,x),k++)})),o.createElement(o.Fragment,null,(0,a.g)(o.createElement(o.Fragment,null,e,o.createElement("cubeCamera",{ref:E,args:[t,n,P]}),f||p?o.createElement(b,{background:!0,files:f,preset:p,path:m,extensions:h}):l?o.createElement(y,{background:!0,map:l,extensions:h}):null),x))}function x(e){var t,n,r,i;const l=w(e),c=e.map||l;o.useMemo((()=>(0,a.e)({GroundProjectedEnvImpl:h})),[]);const u=o.useMemo((()=>[c]),[c]),d=null==(t=e.ground)?void 0:t.height,f=null==(n=e.ground)?void 0:n.radius,m=null!==(r=null==(i=e.ground)?void 0:i.scale)&&void 0!==r?r:1e3;return o.createElement(o.Fragment,null,o.createElement(y,(0,s.Z)({},e,{map:c})),o.createElement("groundProjectedEnvImpl",{args:u,scale:m,height:d,radius:f}))}function P(e){return e.ground?o.createElement(x,e):e.map?o.createElement(y,e):e.children?o.createElement(E,e):o.createElement(b,e)}function k(e){const t=e+"Geometry";return o.forwardRef((({args:e,children:n,...r},a)=>o.createElement("mesh",(0,s.Z)({ref:a},r),o.createElement(t,{attach:"geometry",args:e}),n)))}k("box"),k("circle"),k("cone"),k("cylinder"),k("sphere");const _=k("plane");k("tube"),k("torus"),k("torusKnot"),k("tetrahedron"),k("ring"),k("polyhedron"),k("icosahedron"),k("octahedron"),k("dodecahedron"),k("extrude"),k("lathe"),k("capsule");var M=n(46562),F=n(70224),T=n(11527);const z="https://yunke-oss.oss-cn-hangzhou.aliyuncs.com/bff-basis-fe-sites/files/2022/12/05/1670226065264-0-earth.jpg";function R(){const e=(0,o.useRef)(null),t=((0,a.D)(r.TextureLoader,z),function({size:e=256,frames:t=1/0}={}){const n=(0,a.z)((e=>e.viewport.dpr)),{width:s,height:l}=(0,a.z)((e=>e.size)),c=e||s*n,u=e||l*n,d=o.useMemo((()=>{const e=new r.DepthTexture(c,u);return e.format=r.DepthFormat,e.type=r.UnsignedShortType,{depthTexture:e}}),[c,u]);let f=0;const m=i(c,u,d);return(0,a.A)((e=>{(t===1/0||f<t)&&(e.gl.setRenderTarget(m),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(null),f++)})),m.depthTexture}({size:256}));return(0,T.jsxs)("mesh",{ref:e,children:[(0,T.jsx)(d,{penumbra:.5,depthBuffer:t,position:[3,2,0],intensity:.5,angle:.5,color:"#0EEC82",castShadow:!0}),(0,T.jsx)(f.z,{makeDefault:!0,autoRotate:!0,autoRotateSpeed:.5,minDistance:2,maxDistance:10}),(0,T.jsx)(m,{near:.01,far:50,position:[1,3,1],makeDefault:!0,fov:60}),(0,T.jsx)(P,{preset:"sunset"}),(0,T.jsxs)("mesh",{"position-y":.5,castShadow:!0,children:[(0,T.jsx)("boxGeometry",{}),(0,T.jsx)("meshPhongMaterial",{})]}),(0,T.jsx)(_,{receiveShadow:!0,"rotation-x":-Math.PI/2,args:[100,100],children:(0,T.jsx)("meshPhongMaterial",{})})]})}var C=()=>{const[e,t]=(0,o.useState)(!0);(0,o.useRef)(null);return(0,T.jsxs)("section",{children:[(0,T.jsx)("p",{children:"this is basic demo"}),(0,T.jsx)(F.Z,{onClick:()=>t(!e),children:"toggle"}),(0,T.jsx)(M.Xz,{style:{width:"100%",height:"600px"},children:(0,T.jsx)(R,{})})]})}}}]);